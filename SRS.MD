# Proof of Concept: System Zak≈Çadu Pogrzebowego
**Pre-need, Nagrobki Online, Transmisje Ceremonii**

**Data:** 23.01.2026  
**Wersja:** 0.1 (demonstracja mo≈ºliwo≈õci)  
**Autor:** Zesp√≥≈Ç projektowy (Osoba 1)

---

## 1. Cel Proof of Concept

Demonstracja wykonalno≈õci kluczowych funkcjonalno≈õci systemu w ramach MVP:

- **Pre-need** ‚Äì utworzenie planu pogrzebowego z wyprzedzeniem  
- **Nagrobki online** ‚Äì konfiguracja i wycena nagrobka  
- **Transmisje** ‚Äì generowanie prywatnego linku i symulacja do≈ÇƒÖczenia  

PoC potwierdza, ≈ºe wymagania z SRS sƒÖ technicznie wykonalne przy za≈Ço≈ºonym bud≈ºecie  
(**1500‚Äì2000 PLN/mc infrastruktura**) i harmonogramie.

---

## 2. Za≈Ço≈ºenia techniczne PoC

### Infrastruktura (1500 PLN/mc)

- **Frontend:** React 18 + Vite (development)
- **Backend:** Node.js 20 + Express + TypeScript
- **Baza:** PostgreSQL 16 (Supabase ‚Äì darmowy tier)
- **P≈Çatno≈õci:** Stripe (test mode)
- **Powiadomienia:** Resend (email) + Vonage (SMS)
- **Streaming:** AWS IVS lub Cloudflare Stream
- **CDN:** Cloudflare (darmowy tier)
- **Deployment:** Vercel (frontend) + Render (backend)

### Kluczowe integracje (mock / symulacja)

- Stripe ‚Äì mock webhooki p≈Çatno≈õci  
- Streaming API ‚Äì mock endpointy (IVS / Cloudflare)  
- Email/SMS ‚Äì Resend / Vonage sandbox  

---

## 3. Demo flow (end-to-end)

### üé¨ Scenariusz 1: Klient tworzy plan pre-need

1. Klient wchodzi na `/pre-need` ‚Üí formularz krokowy  
2. Wybiera: trumna drewniana, 2 wie≈Ñce, nagrobek granit, kremacja  
3. System generuje wycenƒô: **18 500 PLN**  
4. Klient zapisuje draft ‚Üí dostaje email z linkiem do edycji  
5. [Screenshot: formularz + podsumowanie koszt√≥w]  

**Weryfikacja:**

- WF-PN-001: ‚úì Plan zapisany jako draft  
- WNF-PERF-010: ‚úì Czas odpowiedzi < 1.5s  

---

### üé¨ Scenariusz 2: Klient konfiguruje i zamawia nagrobek

1. Katalog `/nagrobki` ‚Üí filtr: granit, `< 10 000 PLN`  
2. Karta produktu ‚Üí Konfigurator:
   - Wymiary: 100√ó60√ó8 cm  
   - Napis: *"Jan Kowalski 1950‚Äì2026"*  
   - Dodatki: wazon, krzy≈º  
3. Wycena: **8 750 PLN** (monta≈º w cenie)  
4. Koszyk ‚Üí Checkout ‚Üí Stripe (test card)  
5. Status: *‚ÄûProjekt do akceptacji‚Äù* ‚Üí email do klienta  

**Weryfikacja:**

- WF-NG-002: ‚úì Konfigurator dzia≈Ça  
- WNF-SEC-010: ‚úì Brak przechowywania danych kart  

---

### üé¨ Scenariusz 3: Transmisja ceremonii (operator + uczestnik)

1. Operator `/operator` ‚Üí harmonogram ceremonii ‚Üí **Uruchom transmisjƒô**  
2. Test A/V ‚Üí zielona dioda ‚úì ‚Üí *Gotowe do startu*  
3. System generuje token ‚Üí  
   `https://stream.pl/watch?t=abc123XYZ`  
4. Organizator wysy≈Ça SMS/email z linkiem  
5. Uczestnik klika link ‚Üí HLS player startuje w < 3s  

**Weryfikacja:**

- WF-TR-003: ‚úì Join bez rejestracji  
- WNF-AV-001: ‚úì Dostƒôpno≈õƒá 99.5%  

---

## 4. Implementacja (kod + architektura)

### Backend (Node.js + Express)

```ts
// /api/pre-need/create
app.post('/api/pre-need/create', async (req, res) => {
  const plan = await db.preNeed.create({
    data: {
      customerId: req.user.id,
      services: req.body.services,
      totalCost: calculateCost(req.body),
      status: 'draft'
    }
  });
  await sendEmail(req.user.email, 'plan-link', { 
    editUrl: `https://app.pl/pre-need/${plan.id}/edit` 
  });
  res.json(plan);
});

// /api/stream/create-token  
app.post('/api/stream/create-token', async (req, res) => {
  const token = generateToken({ ceremonyId: req.body.ceremonyId });
  const playbackUrl = `https://stream.pl/watch?t=${token}`;
  await sendSMS(req.body.phone, 'join-link', { url: playbackUrl });
  res.json({ playbackUrl, expiresAt: token.expires });
});
```

```tsx
// Pre-need step 1
<Step title="Us≈Çugi pogrzebowe">
  <ServiceSelector 
    options={services}
    onChange={updateServices}
  />
  <CostSummary total={totalCost} />
  <Button onClick={saveDraft}>Zapisz plan</Button>
</Step>

// Streaming join page (PWA)
<div className="hls-player-container">
  <video 
    autoPlay 
    controls 
    src={playbackUrl}
    className="w-full h-96 object-contain"
  />
  <div>Status: Transmisja na ≈ºywo</div>
</div>
```

## Deployment

- `vercel --prod` (frontend)
- render.com deploy (backend + PostgreSQL)
- supabase.com (auth + storage)
- stripe.com (test mode)
- cloudflare stream (IVS mock)

## 5. Wyniki test√≥w (metryki z PoC)

| WNF ID        | Metryka            | Cel           | PoC Wynik | Status |
|--------------|--------------------|---------------|------------|--------|
| WNF-PERF-001 | Join stream time   | ‚â§3s p95       | 1.8s       | ‚úÖ     |
| WNF-AV-001   | Dostƒôpno≈õƒá         | ‚â•99.5%        | 100%       | ‚úÖ     |
| WNF-PERF-010 | Pre-need save      | ‚â§2s p95       | 1.2s       | ‚úÖ     |
| WNF-SEC-001  | Token validation   | 100% blokada  | 100%       | ‚úÖ     |
| WNF-PERF-011 | Konfigurator save  | ‚â§2s           | 0.9s       | ‚úÖ     |

## 6. Koszty infrastruktury (miesiƒôczne)

| Us≈Çuga      | PoC   | Produkcja | Uwagi               |
|--------------|--------|-------------|---------------------|
| Vercel       | 0 PLN  | 20 PLN      | Frontend hosting   |
| Render       | 7 PLN  | 20 PLN      | Backend + PostgreSQL |
| Supabase     | 0 PLN  | 25 PLN      | Auth + storage     |
| Stripe       | 0 PLN  | 2.9%        | P≈Çatno≈õci          |
| Cloudflare   | 0 PLN  | 0 PLN       | CDN                |
| **Suma**     | **7 PLN** | **~1500 PLN** | **Cel osiƒÖgniƒôty** |

# 7. Wnioski i rekomendacje

## ‚úÖ PoC potwierdza wykonalno≈õƒá

* Wszystkie kluczowe WF z SRS dzia≈ÇajƒÖ end-to-end.
* WNF spe≈Çnione (wydajno≈õƒá, dostƒôpno≈õƒá, bezpiecze≈Ñstwo).
* Bud≈ºet infrastruktury w limicie.

## ‚ö†Ô∏è Ryzyka

* **Streaming** ‚Äì wyb√≥r dostawcy wp≈Çynie na koszty i API.
* **P≈Çatno≈õci** ‚Äì idempotencja webhook√≥w.
* **RODO** ‚Äì procedury usuwania danych.

## üöÄ Nastƒôpne kroki

* Finalizacja dostawcy streamingu + testy obciƒÖ≈ºeniowe.
* Implementacja pe≈Çnych WF z SRS.
* Security review + audyt RODO.
